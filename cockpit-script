
RELEASE_PACKAGE=cockpit
RELEASE_SPEC=tools/cockpit.spec

if [ -n "${RELEASE_HOME:-}" ]; then
    mkdir -p "$RELEASE_HOME/.config"
    set +e
    ln -sf "$RELEASE_HOME/copr-config" "$RELEASE_HOME/.config/copr"
    ln -sf "$RELEASE_HOME/github-token" "$RELEASE_HOME/.config/github-token"
    export HOME="$RELEASE_HOME"
    set -e
fi

# Build the tarball for the tag
job release-tarball

# Do fedora builds for the tag, using tarball
# job release-koji f22
job release-koji f23
job release-koji -k master

# Upload release to github, using tarball
job release-github

# Push to COPR builds
job release-copr sgallagh/cockpit-preview

# Update the Github repo that Docker Hub is tracking
job release-dockerhub cockpit-project/cockpit-container

# Upload documentation
job release-docs doc/guide/html files.cockpit-project.org:/srv/guide
